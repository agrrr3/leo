---
layout: default
title: Expect Guide
expect: true
---

<h1>Expect</h1>

<p>
	The <code>expect</code> style of writing assertions is ideal for BDD testing scenarios. It is useful for creating fluent, readable test expectations.
</p>

<h2 id="expect_language_chains">Language Chains</h2>

<p>Leo provides the following language chains. They exist only to make tests more readable, unless overwritten by a plugin:</p>

<ul>
	<li>to</li>
	<li>be</li>
	<li>been</li>
	<li>is</li>
	<li>and</li>
	<li>has</li>
	<li>have</li>
	<li>with</li>
	<li>that</li>
	<li>at</li>
	<li>of</li>
	<li>same</li>
	<li>an</li>
	<li>a</li>
</ul>

<h2 id="expect_not">->not</h2>

<p>
	Negates the assertion it precedes.
</p>

{% highlight php %}
<?php
expect($name)->to->not->equal('brian');
expect([$obj, 'method'])->to->not->throw('Exception');
expect($obj)->to->have->property('name')
    ->and->not->equal('brian');
?>
{% endhighlight %}

<h2 id="expect_a">->a(type)</h2>

<ul>
	<li>@param <code>string</code> $type</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Performs a type assertion using PHP's <code>gettype</code> function. The alias <code>an</code> can be used as well. Both <code>an</code> and <code>a</code> can be used as language chains.
</p>

{% highlight php %}
<?php
expect('leo')->to->be->a('string');
expect(tmpfile())->to->be->a('resource');
expect([])->to->be->an('array');

//language chain
expect($request)->to->be->an->instanceof('Request');
?>
{% endhighlight %}

<h2 id="expect_include">->include(value)</h2>

<ul>
	<li>@param <code>mixed</code> $value</li>
	<li>@param <code>string </code> $message [optional]</li>
</ul>

<p>
	The <code>include</code> and <code>contain</code> assertions are used to check if an array contains a value or if a string contains a substring. Either can be used as a language chain to enable the <code>contain</code> flag for use with the <code>keys</code> assertion.
</p>

{% highlight php %}
<?php
expect([1,2,3])->to->include(1);
expect('hello world')->to->contain('hello');

//language chain
expect(['name' => 'leo', 'lang' => 'php'])->to->include->keys(['name']);
?>
{% endhighlight %}

<h2 id="expect_ok">->ok</h2>

<ul>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is true when cast to <code>(bool)</code>. Can be used as both a method and a property.
</p>

{% highlight php %}
<?php
expect(true)->to->be->ok;
expect("string")->to->be->ok;
expect([])->to->not->be->ok;

//as a method
expect(1)->to->be->ok();
?>
{% endhighlight %}

<h2 id="expect_true">->true</h2>

<ul>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is exactly <code>true</code>. Can be used as both a method and a property.
</p>

{% highlight php %}
<?php
expect(true)->to->be->true;
expect(1)->to->not->be->true;

//as a method
expect(true)->to->be->true();
?>
{% endhighlight %}

<h2 id="expect_false">->false</h2>

<ul>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is exactly <code>false</code>. Can be used as both a method and a property.
</p>

{% highlight php %}
<?php
expect(false)->to->be->false;
expect(0)->to->not->be->false;

//as a method
expect(false)->to->be->false();
?>
{% endhighlight %}

<h2 id="expect_null">->null</h2>

<ul>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is <code>null</code>. Can be used as both a method and a property.
</p>

{% highlight php %}
<?php
expect(null)->to->be->null;
expect($mybar)->to->not->be->null;

//as a method
expect(null)->to->be->null();
?>
{% endhighlight %}

<h2 id="expect_empty">->empty</h2>

<ul>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is empty via PHP's <code>empty</code> function. Can be used as both a method and a property.
</p>

{% highlight php %}
<?php
expect([]])->to->be->empty;
expect([1,2,3])->to->not->be->empty;

//as a method
expect([])->to->be->empty();
?>
{% endhighlight %}

<h2 id="expect_equal">->equal(value)</h2>

<ul>
	<li>@param <code>mixed</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is strictly <code>===</code> equal to <code>value</code>. For loose comparison, the <code>loosely</code> flag can be used.
</p>

{% highlight php %}
<?php
expect("hello")->to->equal("hello");
expect(1)->to->equal(1);
expect([1,2,3])->to->loosely->equal([1,2,3]);
?>
{% endhighlight %}

<h2 id="expect_above">->above(value)</h2>

<ul>
	<li>@param <code>number</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is greater than <code>value</code>.
</p>

{% highlight php %}
<?php
expect(6)->to->be->above(3);
?>
{% endhighlight %}

<p>
	Can be used with the <code>length</code> flag if the target has a length.
</p>

{% highlight php %}
<?php
expect('string')->to->have->length->above(3);
expect([1,2,3])->to->have->length->above(2);
?>
{% endhighlight %}

<h2 id="expect_least">->least(value)</h2>

<ul>
	<li>@param <code>number</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is greater than or equal to <code>value</code>.
</p>

{% highlight php %}
<?php
expect(6)->to->be->at->least(6);
?>
{% endhighlight %}

<p>
	Can be used with the <code>length</code> flag if the target has a length.
</p>

{% highlight php %}
<?php
expect('string')->to->have->length->of->at->least(3);
expect([1,2,3])->to->have->length->of->at->least(2);
?>
{% endhighlight %}

<h2 id="expect_below">->below(value)</h2>

<ul>
	<li>@param <code>number</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is less than <code>value</code>.
</p>

{% highlight php %}
<?php
expect(3)->to->be->below(6);
?>
{% endhighlight %}

<p>
	Can be used with the <code>length</code> flag if the target has a length.
</p>

{% highlight php %}
<?php
expect('hi')->to->have->length->below(3);
expect([1])->to->have->length->below(2);
?>
{% endhighlight %}

<h2 id="expect_most">->most(value)</h2>

<ul>
	<li>@param <code>number</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is less than or equal to <code>value</code>.
</p>

{% highlight php %}
<?php
expect(3)->to->be->at->most(3);
?>
{% endhighlight %}

<p>
	Can be used with the <code>length</code> flag if the target has a length.
</p>

{% highlight php %}
<?php
expect('hi')->to->have->length->of->at->most(3);
expect([1,2,3])->to->have->length->of->at->most(5);
?>
{% endhighlight %}

<h2 id="expect_within">->within(lower, upper)</h2>

<ul>
	<li>@param <code>number</code> $lower</li>
	<li>@param <code>number</code> $upper</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is between <code>lower</code> (inclusive), and <code>upper</code> (inclusive).
</p>

{% highlight php %}
<?php
expect(3)->to->be->within(2, 4);
?>
{% endhighlight %}

<p>
	Can be used with the <code>length</code> flag if the target has a length.
</p>

{% highlight php %}
<?php
expect('hi')->to->have->length->within(2, 4);
expect([1,2,3])->to->have->length->within(2, 4);
?>
{% endhighlight %}

<h2 id="expect_instanceof">->instanceof(className)</h2>

<ul>
	<li>@param <code>string</code> $className</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target is an instance of the class identified by <code>className</code>
</p>

{% highlight php %}
<?php
expect($request)->to->be->an->instanceof('Symfony\Component\HttpFoundation\Request')
expect($object)->to->be->an->instanceof('stdClass');
?>
{% endhighlight %}

<h2 id="expect_property">->property(name, [value])</h2>

<ul>
	<li>@param <code>string</code> $name</li>
	<li>@param <code>mixed</code> $value [optional]</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target array or object has the given index or property name identified by <code>name</code>. If <code>value</code> is supplied, it will be strictly compared to that property.
</p>

{% highlight php %}
<?php
$person = new stdClass();
$person->name = "brian";

expect($person)->to->have->property('name');
expect($person)->to->have->property('name', 'brian');

$arrayPerson = ['name' => 'brian'];
expect($arrayPerson)->to->have->property('name');
expect($arrayPerson)->to->have->property('name', 'brian');
?>
{% endhighlight %}

<p>
	When used with the <code>deep</code> flag, the property assertion can traverse nested structures as well.
</p>

{% highlight php %}
<?php
$person = new stdClass();
$person->name = new stdClass();
$person->name->first = "brian";

expect($person)->to->have->a->deep->property('name->first');
expect($person)->to->have->a->deep->property('name->first', 'brian');

$arrayPerson = [
    'name' => 'brian', 
    'hobbies' => [
        'programming',
        'reading',
        'music'
    ]
];

expect($arrayPerson)->to->have->deep->property('hobbies[0]');
expect($arrayPerson)->to->have->deep->property('hobbies[2]', 'music');
?>
{% endhighlight %}

<p>
	A note on the property assertion: The property assertion sets the subject of the assertion to the targeted property for further chaining.
</p>

{% highlight php %}
<?php
$person = new stdClass();
$person->name = new stdClass();
$person->name->first = "brian";

expect($person)
    ->to->have->a->deep->property('name->first')
    ->that->has->length(5);
?>
{% endhighlight %}

<h2 id="expect_length">->length(value)</h2>

<ul>
	<li>@param <code>number</code> $value</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that a target with length has the length of <code>value</code>. A target has length if it is a string, an array, or implements the <code>Countable</code> interface.
</p>

{% highlight php %}
<?php
expect('hello')->to->have->length(5);
expect([1,2,3])->to->have->length(3);
?>
{% endhighlight %}

<p>
	This assertion can also be used as a language flag for comparison assertions.
</p>

{% highlight php %}
<?php
expect([1,2,3])->to->have->length->above(2);
expect('hello')->to->have->length->below(10);
?>
{% endhighlight %}

<h2 id="expect_match">->match(pattern)</h2>

<ul>
	<li>@param <code>string</code> $pattern</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	The match assertion matches the target string against a regexp string.
</p>

{% highlight php %}
<?php
expect('hello')->to->match('/^he/');
?>
{% endhighlight %}

<h2 id="expect_string">->string(string)</h2>

<ul>
	<li>@param <code>string</code> $string</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target string contains the substring <code>string</code>.
</p>

{% highlight php %}
<?php
expect('goodbye')->to->have->string('good');
?>
{% endhighlight %}

<h2 id="expect_keys">->keys(keys)</h2>

<ul>
	<li>@param <code>array</code> $keys</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target array or object has exactly the keys given. Asserts the inclusion of <em>some</em> keys if the <code>contain</code> or <code>include</code> flag is used.
</p>

{% highlight php %}
<?php
$pet = new stdClass();
$pet->name = 'fido';
$pet->age = 7;

expect($pet)->to->have->keys(['name', 'age']);

$petArray = ['name' => 'fido', 'age' => 7, 'breed' => 'terrier'];
expect($petArray)->to->include->keys(['name', 'age']);
?>
{% endhighlight %}

<h2 id="expect_throw">->throw(exceptionClass, [exceptionMessage])</h2>

<ul>
	<li>@param <code>string</code> $exceptionClass</li>
	<li>@param <code>string</code> $exceptionMessage [optional]</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target callable throws an exception that is an instance of <code>exceptionClass</code>. If <code>exceptionMessage</code> is provided it will also assert that the exception messages are the same. The <code>with</code> method can be used to pass arguments to the target callable.
</p>

{% highlight php %}
<?php
expect([$object, 'method'])->to->throw('RuntimeException');
expect(function($msg) { throw new Exception($msg) })
    ->with('hello')->to->throw('Exception', 'hello');

expect([$object, 'method'])->to->not->throw('Exception');
?>
{% endhighlight %}

<h2 id="expect_satisfy">->satisfy(callable)</h2>

<ul>
	<li>@param <code>callable</code> $callable</li>
	<li>@param <code>string</code> $message [optional]</li>
</ul>

<p>
	Asserts that the target satisfies a predicate function.
</p>

{% highlight php %}
<?php
expect(1)->to->satisfy('is_numeric');
expect('curly')->to->satisfy(function ($stooge) {
	return preg_match('/curly|larry|moe/', $stooge);
});
?>
{% endhighlight %}